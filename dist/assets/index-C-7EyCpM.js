(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function s(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(t){if(t.ep)return;t.ep=!0;const a=s(t);fetch(t.href,a)}})();let De=0,ie=0,ve=0,w=[],Te=[],ce,Ee=0,ae=0,R=[],X,ye,Be=0,l,P=[],S=[],ne=0,le=0,ge=0,v=0,Ie=0;const g=(e,n)=>Math.floor(Math.random()*(n-e+1))+e;let u=2.5,E=!1,ee=!1,x=!1,y,L,i,A,we,ke=0,F=0;const Ae=160*3;let J=g(800,1600),se=0,be,_=[],Z=0,Se,j,G,Y,N,V,$,oe,re,W,Q,he,pe,fe,ue,b,me,B=[],C=[],D=[],I=[],T=[],M=0,O;const Oe=.15,He=-10,U=370;function Re(e){let n=0,s=18;j=new Image,j.src="assets/denis_runner.png",j.onload=t,G=new Image,G.src="assets/coin.png",G.onload=t,Y=new Image,Y.src="assets/pothole.png",Y.onload=t,N=new Image,N.src="assets/service.png",N.onload=t,V=new Image,V.src="assets/check_engine.png",V.onload=t,$=new Image,$.src="assets/inspector.png",$.onload=t,oe=new Image,oe.src="assets/quadro.png",oe.onload=t,re=new Image,re.src="assets/quadro1.png",re.onload=t,Q=new Image,Q.src="assets/game_over_screen.webp",Q.onload=t,he=new Audio("assets/start.mp3"),he.addEventListener("canplaythrough",t,{once:!0}),pe=new Audio("assets/inspector_sfx.mp3"),pe.addEventListener("canplaythrough",t,{once:!0}),fe=new Audio("assets/service.mp3"),fe.addEventListener("canplaythrough",t,{once:!0}),b=new Audio("assets/death_sfx.mp3"),b.addEventListener("canplaythrough",t,{once:!0}),ue=new Audio("assets/Check_Sound.mp3"),ue.addEventListener("canplaythrough",t,{once:!0}),s+=1,W=new Image,W.src="assets/Valera_runner.png",W.onload=t,me=new Audio("assets/valera.mp3"),me.addEventListener("canplaythrough",t,{once:!0}),X=new Image,X.src="assets/danya.png",X.onload=t,ye=new Audio("assets/danya.mp3"),ye.addEventListener("canplaythrough",t,{once:!0}),s+=2,["Cortage1.png","Cortage2.png","Cortage3.png","Cortage4.png","Cortage5.png","Cortage6.png","Cortage7.png","Cortage8.png"].forEach(a=>{const r=new Image;r.src="assets/"+a,r.onload=t,Te.push(r),s+=1}),ce=new Audio("assets/cortage.mp3"),ce.addEventListener("canplaythrough",t,{once:!0}),s+=1,L=new Image,L.src="assets/city_background.webp",L.onload=()=>{L.width=1536,L.height=1024,t()},y=new Audio("assets/bgMusic.mp3"),y.volume=.5,y.addEventListener("canplaythrough",t,{once:!0}),we=new Image,we.src="assets/splash_screen.webp",we.onload=t;function t(){n++,n===s&&e()}}const q=215;function Xe(){return{x:50,y:q,width:160,height:80,vy:0,onGround:!0,sprite:null,tiltAngle:0,jumpStage:0}}function H(){document.getElementById("scoreDisplay").style.display="block",document.getElementById("bestDisplay").style.display="block",document.getElementById("killDisplay").style.display="block";const e=document.getElementById("restartButton");e&&(e.style.display="none"),Be=0,totalServicePaid=0,totalInspectorPaid=0,v=0,ge=0,le=0,Ie=0,l=Xe(),P=[],S=[],B=[],C=[],D=[],I=[],T=[],_=[],x=!1,E=!1,u=2.5,y&&(y.currentTime=0,y.pause()),M=0,O=canvas.width,Z=0,Se=g(1e3,1500),F=0,J=g(800,1600),se=0,be=g(1e4,2e4),R=[],w=[],Ee=g(1e4,2e4),ae=0,ie=0,ve=g(5e3,1e4)}function de(){H(),E=!0,y&&(y.currentTime=0,y.play().catch(e=>{console.warn("Audio autoplay failed:",e)}))}function Le(){const e=Math.random(),n=75,s=U-n/2-canvas.height*.28;if(e<.25)P.push({x:800,y:s,width:n,height:n,speed:6});else if(e<.5)I.push({x:800,y:40,width:100,height:60,speed:6,falling:!1});else if(e<.65){const o=U-37.5-canvas.height*.28;C.push({x:800,y:o,width:80,height:80,hitboxOffsetX:20,hitboxWidth:40,hitboxHeight:40})}else if(e<.85)D.push({x:800,y:60,width:75,height:75,speed:6});else{const o=U-37.5-canvas.height*.28;B.push({x:800,y:o,width:50,height:70,speed:6})}}function _e(){S.push({x:800,y:Math.random()*180+40,width:75,height:75,speed:6})}function Pe(){document.addEventListener("keydown",e=>{ee&&(!E&&e.code==="Space"&&de(),x&&(e.code==="Space"||e.code==="Enter"||e.key==="Enter")&&(e.preventDefault(),H()),!(!E||x)&&E&&!x&&(e.code==="ArrowUp"||e.code==="Space")&&l.onGround&&(l.vy=He,l.onGround=!1,l.jumpStage=1))})}function je(e){j&&j.complete&&(i.save(),i.translate(e.x+e.width/2,e.y+e.height/2),i.rotate(l.tiltAngle*Math.PI/180),i.drawImage(j,-e.width/2,-e.height/2,e.width,e.height),i.restore())}function Ge(e){Y&&Y.complete?i.drawImage(Y,e.x,e.y,e.width,e.height):(i.fillStyle="#222",i.fillRect(e.x,e.y,e.width,e.height))}function Ye(e){G&&G.complete?i.drawImage(G,e.x,e.y,e.width,e.height):(i.fillStyle="gold",i.beginPath(),i.arc(e.x+e.width/2,e.y+e.height/2,e.width/2,0,2*Math.PI),i.fill())}function Ne(e){N&&N.complete?i.drawImage(N,e.x,e.y,e.width,e.height):(i.fillStyle="#0f0",i.fillRect(e.x,e.y,e.width,e.height))}function Ve(e){V&&V.complete?i.drawImage(V,e.x,e.y,e.width,e.height):(i.fillStyle="#ff0",i.fillRect(e.x,e.y,e.width,e.height))}function $e(e){$&&$.complete?i.drawImage($,e.x,e.y,e.width,e.height):(i.fillStyle="#f00",i.fillRect(e.x,e.y,e.width,e.height))}function We(e){const n=e.falling?re:oe;n&&n.complete?i.drawImage(n,e.x,e.y,e.width,e.height):(i.fillStyle="#0ff",i.fillRect(e.x,e.y,e.width,e.height))}function Qe(){const e=document.getElementById("scoreDisplay");e&&(e.innerText="Километраж: "+ge.toFixed(2)+" км",e.style.position="absolute",e.style.textShadow="2px 2px 4px rgba(0,0,0,0.6)",e.style.left="20px",e.style.top="10px",e.style.right="auto",e.style.transform="none",e.style.textAlign="left",e.style.zIndex="10",e.style.fontFamily="Arial",e.style.fontSize="24px",e.style.color="white",e.style.display="block");let n=document.getElementById("coinDisplay");if(n||(n=document.createElement("div"),n.id="coinDisplay",document.body.appendChild(n)),!x)n.innerText="Монеты: "+v+" 💸",n.style.position="absolute",n.style.left="20px",n.style.top="40px",n.style.right="auto",n.style.transform="none",n.style.textAlign="left",n.style.zIndex="10",n.style.fontFamily="Arial",n.style.fontSize="24px",n.style.color="white",n.style.textShadow="2px 2px 4px rgba(0,0,0,0.6)",n.style.display="block";else{n.style.display="none";const s=document.getElementById("summaryDisplay");s&&(s.style.display="none");const o=document.getElementById("paymentsDisplay");o&&(o.style.display="none")}}function Ue(){if(!E||x||!ee)return;E&&(u+=2e-5,se+=u,ie+=u,ae+=u,_.length===0&&R.length===0&&w.length===0&&(ae>=Ee?(Ze(),ae=0,Ee=g(1e4,2e4)):se>=be?(Ke(),se=0,be=g(5e3,1e4)):ie>=ve&&(Je(),ie=0,ve=g(5e3,1e4))),w.forEach((a,r)=>{r===0&&!a.audioPlayed&&a.x-l.x<=500&&(ce.currentTime=0,ce.play().catch(()=>{}),a.audioPlayed=!0),a.x-=u*1.32}),w.length>0&&w[w.length-1].x+w[w.length-1].width<0&&(w=[])),F+=6,le+=u;const e=le/(160/3);ge=e/1e3,e-Ie>=500&&(v+=50,Ie+=500),M-=u,O-=u,M<=-canvas.width&&(M=O+canvas.width),O<=-canvas.width&&(O=M+canvas.width),l.vy+=Oe,l.y+=l.vy;let n=0;l.y>=q?(l.y=q,l.vy=0,l.onGround=!0,l.jumpStage=0,n=0):(l.onGround=!1,l.jumpStage===1?(n=-45,l.vy>=0&&(l.jumpStage=2)):l.jumpStage===2?(n=0,l.vy>0&&(l.jumpStage=3)):l.jumpStage===3&&(n=45)),l.tiltAngle+=(n-l.tiltAngle)*.1;const s={x:l.x,y:l.y,width:l.width,height:l.height};Z+=6,Z>=Se&&F>=Ae+J&&(Le(),Z=0,Se=g(1e3,1500),F=0,J=g(800,1600)),F>=Ae+J&&(Le(),Z=0,F=0,J=g(800,1600));const o=le/(160/3);o-De>=g(100,200)&&(_e(),De=o),P.forEach(t=>t.x-=u),P=P.filter(t=>t.x+t.width>0),S.forEach(t=>t.x-=u),S=S.filter(t=>t.x+t.width>0),B.forEach(t=>t.x-=u),C.forEach(t=>t.x-=u),D.forEach(t=>t.x-=u),I.forEach(t=>t.x-=u),B=B.filter(t=>t.x+t.width>0),C=C.filter(t=>t.x+t.width>0),D=D.filter(t=>t.x+t.width>0),I=I.filter(t=>t.x+t.width>0),_.forEach((t,a)=>{!t.audioPlayed&&t.x-l.x<=700&&(me.currentTime=0,me.play().catch(()=>{}),t.audioPlayed=!0),t.x-=u*1.2,t.x+t.width<0&&_.splice(a,1)}),R.forEach((t,a)=>{!t.audioPlayed&&t.x-l.x<=700&&(ye.currentTime=0,ye.play().catch(()=>{}),t.audioPlayed=!0),t.x-=u*1.1,t.x+t.width<0&&R.splice(a,1)}),P.forEach(t=>{const a={x:t.x+t.width/2-2.5,y:t.y+t.height/2-2.5,width:5,height:5};k(s,a)&&(x=!0,y&&y.pause(),b.currentTime=0,b.play())}),S.forEach((t,a)=>{k(s,t)&&(v+=25,T.push({x:l.x+l.width/2,y:l.y,text:"+25",color:"green",alpha:1}),S.splice(a,1))}),B.forEach((t,a)=>{const r={x:t.x,y:t.y+15,width:t.width,height:t.height};k(s,r)&&(B.splice(a,1),v>=50?(v-=50,totalInspectorPaid+=50,T.push({x:l.x+l.width/2,y:l.y,text:"-50",color:"red",alpha:1}),pe.currentTime=0,pe.play()):(x=!0,y&&y.pause(),b.currentTime=0,b.play()))}),C.forEach((t,a)=>{const r={x:t.x+(t.hitboxOffsetX||0),y:t.y+(t.height-(t.hitboxHeight||t.height))/2,width:t.hitboxWidth||t.width,height:t.hitboxHeight||t.height};k(s,r)&&(v>=100?(v-=100,totalServicePaid+=100,T.push({x:l.x+l.width/2,y:l.y,text:"-100",color:"red",alpha:1}),fe.currentTime=0,fe.play()):(x=!0,y&&y.pause(),b.currentTime=0,b.play()),C.splice(a,1))}),D.forEach((t,a)=>{k(s,t)&&(x=!0,y&&y.pause(),ue.currentTime=0,ue.play(),D.splice(a,1))}),I.forEach((t,a)=>{const p={x:t.x-10,y:t.y-10,width:t.width+20,height:t.height+20};if(!t.falling&&k(s,p)){t.falling=!0;const d=.3*60;t.vyFall=(q-t.y)/d,T.push({x:l.x+l.width/2,y:l.y,text:"+50",color:"green",alpha:1}),Be++,v+=50}}),I.forEach((t,a)=>{t.falling&&(t.y+=t.vyFall,(k(s,t)||t.y+t.height>=q)&&I.splice(a,1))}),e-ke>=500&&(u=Math.min(u+.1,6),ke=e)}function k(e,n){return e.x<n.x+n.width&&e.x+e.width>n.x&&e.y<n.y+n.height&&e.y+e.height>n.y}function te(){if(i.clearRect(0,0,canvas.width,canvas.height),A.clearRect(0,0,uiCanvas.width,uiCanvas.height),x){const e=document.getElementById("scoreDisplay");e&&(e.style.display="none");const n=document.getElementById("coinDisplay");n&&(n.style.display="none"),Q&&Q.complete&&(i.clearRect(0,0,canvas.width,canvas.height),i.drawImage(Q,0,0,canvas.width,canvas.height));const s="Arial",o="24px",t="8px",a=document.getElementById("summaryDisplay")||document.createElement("div");a.id="summaryDisplay",a.innerText=`Километраж: ${ge.toFixed(2)} км | Монеты: ${v} 💸`,a.style.position="absolute",a.style.left="50%",a.style.transform="translateX(-50%)",a.style.textAlign="center",a.style.zIndex="6",a.style.top="calc(35% + 0px)",a.style.display="block",a.style.fontFamily=s,a.style.fontSize=o,a.style.color="white",a.style.textShadow="2px 2px 4px rgba(0,0,0,0.6)",document.body.appendChild(a);const r=document.getElementById("bestDisplay");r&&(v>ne&&(ne=v),r.innerText="Рекорд по монетам: "+ne,r.innerText="Рекорд по монетам: "+ne,r.style.position="absolute",r.style.left="50%",r.style.transform="translateX(-50%)",r.style.textAlign="center",r.style.zIndex="6",r.style.top="calc(35% + 40px)",r.style.display="block",r.style.fontFamily=s,r.style.fontSize=o,r.style.marginBottom=t);const p=document.getElementById("killDisplay");p&&(p.innerHTML='Квадрокоптеров сбито: <span style="color:#7CFC00;">'+Be+"</span>",p.style.position="absolute",p.style.left="50%",p.style.transform="translateX(-50%)",p.style.textAlign="center",p.style.zIndex="6",p.style.top="calc(35% + 80px)",p.style.display="block",p.style.fontFamily=s,p.style.fontSize=o,p.style.marginBottom=t,p.style.color="white");let d=document.getElementById("paymentsDisplay");for(d||(d=document.createElement("div"),d.id="paymentsDisplay",document.body.appendChild(d)),d.style.position="absolute",d.style.left="50%",d.style.transform="translateX(-50%)",d.style.textAlign="center",d.style.zIndex="6",d.style.top="calc(35% + 120px)",d.style.fontFamily=s,d.style.fontSize=o,d.style.marginBottom=t,d.style.background="none",d.style.border="none",d.style.width="auto",d.style.padding="0",d.style.borderRadius="0";d.firstChild;)d.removeChild(d.firstChild);let K=!1;if(typeof totalServicePaid<"u"&&totalServicePaid>0){const c=document.createElement("div");c.innerHTML='В сервисе заплатили: <span style="color: red;">-'+totalServicePaid+"</span>",c.style.color="black",c.style.marginBottom=t,c.style.fontFamily=s,c.style.fontSize=o,c.style.padding="5px 10px",c.style.border="1px solid white",c.style.borderRadius="10px",c.style.backgroundColor="white",c.style.display="inline-block",d.appendChild(c),K=!0}if(typeof totalInspectorPaid<"u"&&totalInspectorPaid>0){const c=document.createElement("div");c.innerHTML='Капустникам заплатили: <span style="color: red;">-'+totalInspectorPaid+"</span>",c.style.color="black",c.style.marginBottom=t,c.style.fontFamily=s,c.style.fontSize=o,c.style.padding="5px 10px",c.style.border="1px solid white",c.style.borderRadius="10px",c.style.backgroundColor="white",c.style.display="inline-block",d.appendChild(c),K=!0}d.style.display=K?"block":"none";let h=document.getElementById("restartButton");h||(h=document.createElement("div"),h.id="restartButton",document.body.appendChild(h)),h.style.position="absolute",h.style.left="50%",h.style.transform="translateX(-50%)",h.style.top="calc(35% + 240px)",h.style.width="200px",h.style.height="50px",h.style.background="#ddd",h.style.border="2px solid #aaa",h.style.textAlign="center",h.style.lineHeight="50px",h.style.fontFamily=s,h.style.fontSize="20px",h.style.cursor="pointer",h.style.zIndex="5",h.innerText="Начать заново",h.style.display="block";let f=document.getElementById("enterHint");f||(f=document.createElement("div"),f.id="enterHint",document.body.appendChild(f)),f.style.position="absolute",f.style.left="50%",f.style.transform="translateX(-50%)",f.style.top="calc(35% + 295px)",f.style.width="200px",f.style.textAlign="center",f.style.fontFamily=s,f.style.fontSize="16px",f.style.color="white",f.style.zIndex="5",f.innerText="or press Enter",f.style.display="block",requestAnimationFrame(te);return}else{const e=document.getElementById("restartButton");e&&(e.style.display="none");const n=document.getElementById("paymentsDisplay");n&&(n.style.display="none");const s=document.getElementById("enterHint");s&&(s.style.display="none"),document.getElementById("scoreDisplay").style.display="none",document.getElementById("bestDisplay").style.display="none",document.getElementById("killDisplay").style.display="none";const o=document.getElementById("paymentsDisplay");o&&(o.style.display="none");const t=document.getElementById("summaryDisplay");t&&(t.style.display="none");const a=document.getElementById("scoreDisplay");a&&(a.style.display="none");const r=document.getElementById("coinDisplay");r&&(r.style.display="none")}i.drawImage(L,Math.round(M),0,canvas.width,canvas.height),i.save(),i.scale(-1,1),i.drawImage(L,-Math.round(O)-canvas.width,0,canvas.width,canvas.height),i.restore(),P.forEach(Ge),S.forEach(Ye),_.forEach(e=>{W&&W.complete&&(i.save(),i.translate(e.x+e.width/2,e.y+e.height/2),i.scale(-1,1),i.drawImage(W,-e.width/2,-e.height/2,e.width,e.height),i.restore())}),R.forEach(e=>{X&&X.complete&&(i.save(),i.translate(e.x+e.width/2,e.y+e.height/2),i.scale(1,1),i.drawImage(X,-e.width/2,-e.height/2,e.width,e.height),i.restore())}),w.forEach(e=>{e.img&&e.img.complete&&(i.save(),e.flip?(i.translate(e.x+e.width,e.y),i.scale(-1,1),i.drawImage(e.img,0,0,e.width,e.height)):(i.translate(e.x,e.y),i.scale(1,1),i.drawImage(e.img,0,0,e.width,e.height)),i.restore())}),w.forEach(e=>{e.img&&e.img.complete&&(i.save(),e.flip?(i.translate(e.x+e.width,e.y),i.scale(-1,1),i.drawImage(e.img,0,0,e.width,e.height)):(i.translate(e.x,e.y),i.scale(1,1),i.drawImage(e.img,0,0,e.width,e.height)),i.restore())}),C.forEach(Ne),D.forEach(Ve),B.forEach($e),I.forEach(We),l&&je(l),T.forEach((e,n)=>{A.globalAlpha=e.alpha,A.fillStyle=e.color,A.font="28px Arial",A.fillText(e.text,e.x,e.y),e.y-=1,e.alpha-=.02,e.alpha<=0&&T.splice(n,1)}),A.globalAlpha=1,Qe(),Ue(),requestAnimationFrame(te)}typeof totalServicePaid>"u"&&(window.totalServicePaid=0);typeof totalInspectorPaid>"u"&&(window.totalInspectorPaid=0);document.addEventListener("DOMContentLoaded",()=>{if(window.canvas=document.getElementById("gameCanvas"),window.uiCanvas=document.getElementById("uiCanvas"),canvas&&uiCanvas){i=canvas.getContext("2d"),A=uiCanvas.getContext("2d");const e=document.getElementById("uiOverlay");e&&(e.style.pointerEvents="none"),canvas.addEventListener("mousedown",()=>{y&&y.paused&&ee&&y.play().catch(()=>{})}),canvas.addEventListener("touchstart",()=>{y&&y.paused&&ee&&y.play().catch(()=>{})}),document.addEventListener("click",function(o){const t=document.getElementById("restartButton");t&&t.style.display!=="none"&&o.target===t&&(E=!1,x=!1,H(),de())}),document.addEventListener("DOMContentLoaded",function(){const o=document.getElementById("restartButton");o&&o.addEventListener("click",function(){E=!1,x=!1,H(),de()})});const n=document.getElementById("startButton"),s=document.getElementById("startOverlay");n&&s&&n.addEventListener("click",()=>{s.style.display="none";const o=document.getElementById("loaderSound");o&&(o.currentTime=0,o.volume=.5,o.play().catch(()=>{})),Re(()=>{H(),Pe();const t=document.getElementById("loaderOverlay"),a=document.getElementById("loaderBar"),r=document.getElementById("loaderCar"),p=document.getElementById("loaderText"),d=6e3,K=Date.now();function h(){const f=Math.min((Date.now()-K)/d,1),c=Math.floor(f*100);if(a&&(a.style.width=c+"%"),r&&(r.style.left=`calc(${c}% - 40px)`),p&&(p.innerText=`Loading... ${c}%`),f<1)requestAnimationFrame(h);else{t&&(t.style.display="none"),te();const m=document.createElement("div");m.id="countdown",m.style.position="absolute",m.style.top="50%",m.style.left="50%",m.style.transform="translate(-50%, -50%)",m.style.fontSize="96px",m.style.color="white",m.style.fontFamily="Arial",m.style.zIndex="20",m.style.pointerEvents="none",document.getElementById("uiOverlay").appendChild(m);const xe=["READY","SET","GO"];let z=0;const Ce=["red","orange","lime"];m.innerText=xe[z],m.style.color=Ce[z],he.currentTime=0,he.play().catch(()=>{});const ze=setInterval(()=>{z++,z<xe.length?(m.innerText=xe[z],m.style.color=Ce[z]):(clearInterval(ze),m.remove(),y&&(y.currentTime=0,y.play().catch(()=>{})),H(),te(),document.addEventListener("keydown",function Fe(Me){Me.code==="Space"&&(ee=!0,E=!0,Pe(),de(),te(),document.removeEventListener("keydown",Fe))}))},1e3)}}h()})})}else console.error('Canvas не найден! Убедитесь, что элементы canvas с id "gameCanvas" и "uiCanvas" существуют.')});function Ke(){const n=U-37.5-canvas.height*.28;_.push({x:canvas.width,y:n-canvas.height*.07,width:l.width,height:l.height,audioPlayed:!1})}function Je(){const n=U-37.5-canvas.height*.28;R.push({x:canvas.width,y:n-canvas.height*.07,width:160,height:80,audioPlayed:!1})}function Ze(){const n=U-37.5-canvas.height*.28,s=canvas.width,o=160,t=80,a=o;Te.forEach((r,p)=>{w.push({x:s+p*(o+a),y:n-canvas.height*.07,width:o,height:t,img:r,audioPlayed:!1,flip:!0})})}
